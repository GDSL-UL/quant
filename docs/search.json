[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Human Geography through Merseyside - Quantitative Block: Seeing the world through numbers",
    "section": "",
    "text": "Welcome\nThis is the website for “Human Geography through Merseyside - Quantitative Block: Seeing the world through numbers” (module ENVS162) at the University of Liverpool. This block of the module is designed and delivered by Dr. Zi Ye and Dr. Ron Mahabir from the Geographic Data Science Lab at the University of Liverpool. The module seeks to provide hands-on experience and training in introductory statistics for human geographers.\nThe website is free to use and is licensed under the Attribution-NonCommercial-NoDerivatives 4.0 International. A compilation of this web course is hosted as a GitHub repository that you can access:",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "index.html#contact",
    "href": "index.html#contact",
    "title": "Human Geography through Merseyside - Quantitative Block: Seeing the world through numbers",
    "section": "Contact",
    "text": "Contact\n\nZi Ye - zi.ye [at] liverpool.ac.uk Lecturer in Geographic Information Science Office 107, Roxby Building, University of Liverpool - 74 Bedford St S, Liverpool, L69 7ZT, United Kingdom.\n\n\nRon Mahabir - Ron.Mahabir [at] liverpool.ac.uk Lecturer in Geographic Data Science Office 4xx, Roxby Building, University of Liverpool - 74 Bedford St S, Liverpool, L69 7ZT, United Kingdom.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "general/overview.html",
    "href": "general/overview.html",
    "title": "Overview",
    "section": "",
    "text": "Aim and Learning Objectives\nThis sub-module aims to provide training and skills on a set of basic quantitative skills for data collection, analysis, and interpretation and to enable you to link conceptual ideas with real world examples. This block serves as the foundation for Year 2 BA field class and, optionally, for Year 3 dissertation.\nBackground\nData and research are key pillars of the global economy and society today. We need rigorous approaches to collecting and analysing both the statistics that can tell us ‘how much’ and if there are observable relationships between phenomena; and the information gives us a nuanced understanding of cultural contexts and human dynamics. Quantitative skills enable us to explore and measure socio-economic activities and processes at large scales, while qualitative skills enable understanding of social, cultural, and political contexts and diverse lived experiences. Rather than being in opposition, qualitative and quantitative research can complement one another in the investigation of today’s pressing research questions.\nTo these ends, this block will help you develop your quantitative skills, as critical tools. This course will help you understand what quantitative statistical researchers use and develop a set of research techniques that can be used in your field classes and dissertations.\nLearning objectives:",
    "crumbs": [
      "Overview"
    ]
  },
  {
    "objectID": "general/overview.html#aim-and-learning-objectives",
    "href": "general/overview.html#aim-and-learning-objectives",
    "title": "Overview",
    "section": "",
    "text": "Understand how to explore a dataset, containing a number of observations described by a set of variables.\nDemonstrate an understanding in the application and interpretation of commonly used quantitative research methods.\nAbility to work with quantitative data to understand real-world social phenomenian and patterns.",
    "crumbs": [
      "Overview"
    ]
  },
  {
    "objectID": "general/overview.html#module-structure",
    "href": "general/overview.html#module-structure",
    "title": "Overview",
    "section": "Module Structure",
    "text": "Module Structure\nStaff: Dr Zi Ye and Dr Ron Mahabir\nWhere and When\nWeek 1 - 5 Lecture: Tuesday (12am – 1pm) @ Mathematical Sciences, Proudman Lecture Theatre\nWeek 1 - 6 Practical PC session: Friday (9 – 11 am) @ Central Teaching Lab: PC Teaching Centre\nLectures will introduce and explain the fundamentals of quantitative methods, with the opportunity to apply the method introduced in the labs later in the week.\nThe computer practical sessions, will give you the chance to use and apply quantitative methods to real-world data. These are primarily self-directed sessions, but with support on hand if you get stuck. Support and training in R will be provided through these sessions. Weekly sessions will be driven by empirical research questions.\n\n\n\n\n\n\n\n\n\nWeek\nTopic\nFormat\nStaff\n\n\n\n\n1\nIntroduction\nGetting Started in RStudio: Knowing Merseyside\nLecture\nComputer Lab Practical\nZY/RM\n\n\n2\nExploratory Data Analysis: UK Election\nLecture and Computer Lab Practical\nZY\n\n\n3\nSampling and data manipulation: Happiness around the world\nLecture and Computer Lab Practical\nZY\n\n\n4\nCorrelation, data reliability and the issue of scale: Health\nLecture and Computer Lab Practical\nRM\n\n\n5\nHow robust are my findings\nLecture and Computer Lab Practical\nRM\n\n\n6\nOnline Assessment\nComputer Lab\nRM/ZY",
    "crumbs": [
      "Overview"
    ]
  },
  {
    "objectID": "general/overview.html#software-and-data",
    "href": "general/overview.html#software-and-data",
    "title": "Overview",
    "section": "Software and Data",
    "text": "Software and Data\nFor quantitative training sessions, ensure you have installed and/or have access to RStudio. To run the analysis and reproduce the code in R, you need the following software installed on your machine:\n\nR-4.2.2 (or later)\nRStudio 2022.12.0-353 (or later)\n\nTo install and update:\n\nR, download the appropriate version from The Comprehensive R Archive Network (CRAN).\nRStudio, download the appropriate version from here.\n\nThis software is already installed on University Machines. But you will need it to run the analysis on your personal devices.\nData\nExample datasets could be accessed through ENVS 162 Canvas module every week.",
    "crumbs": [
      "Overview"
    ]
  },
  {
    "objectID": "general/assessment.html",
    "href": "general/assessment.html",
    "title": "Assessment",
    "section": "",
    "text": "Week 6 Computer-based ‘open book’ multiple-choice exam\n\nThe online assessment will be released at 4pm on Thursday 5th March and should be completed by 4pm on Friday 6th March.\nAlso available 06/03/2025 9:00 – 11:00 CTL PC Teaching Centre (1st Floor CTL)\nShould take less 90 minutes; c. 20 questions; 24 hours to complete\nQuestions and answers randomised for each student (anti-cheating measure)\nSome questions of factual recall, more requiring data analysis to find answers\n\nPreparation for assessment\n\nWeekly lecture & weekly computer practical ‘clinic sessions’\nWeekly holding hands formative tasks at the last 20 mins of the practical session\nWeek 5 mock online test",
    "crumbs": [
      "Assessment"
    ]
  },
  {
    "objectID": "labs/01.GettingStartedinRStudio.html",
    "href": "labs/01.GettingStartedinRStudio.html",
    "title": "1  Lab: Getting Started in RStudio - Knowing Merseyside",
    "section": "",
    "text": "1.1 Overview\nThis practical intend to prepare students who have limited experiences with R and RStudio. The content are adapted based on",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab: Getting Started in RStudio - Knowing Merseyside</span>"
    ]
  },
  {
    "objectID": "labs/01.GettingStartedinRStudio.html#overview",
    "href": "labs/01.GettingStartedinRStudio.html#overview",
    "title": "1  Lab: Getting Started in RStudio - Knowing Merseyside",
    "section": "",
    "text": "Brunsdon, Chris, and Lex Comber. 2018. An Introduction to r for Spatial Analysis and Mapping (2e). Sage.\nComber, Lex, and Chris Brunsdon. 2021. Geographical Data Science and Spatial Data Analysis: An Introduction in r. Sage.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab: Getting Started in RStudio - Knowing Merseyside</span>"
    ]
  },
  {
    "objectID": "labs/01.GettingStartedinRStudio.html#getting-set-up-with-rstudio",
    "href": "labs/01.GettingStartedinRStudio.html#getting-set-up-with-rstudio",
    "title": "1  Lab: Getting Started in RStudio - Knowing Merseyside",
    "section": "1.2 Getting set up with RStudio",
    "text": "1.2 Getting set up with RStudio\n\n1.2.1 Install R and RStudio (if necessary)\nR is a free, open-source programming language used for statistical analysis, data visualization, and data science\nRStudio is a free front-end to R, designed to make using R easier\nAll of the PCs in the University PC Teaching Centre used for this class come with R and RStudio pre-installed, as do the PCs in many other University PC Teaching Centres.\nHowever, you may wish to install R and RStudio on your own computer, or on a University PC that lacks them.\nUniversity computers: Use the Install University Applications app on the computer to install the latest version of RStudio (this will also install the latest version of R)\nYour own computer: R and RStudio can be downloaded from the CRAN website and installed your own computer - see below for details. A key point is that you should install R before you install RStudio.\nThe simplest way to get R installed on your computer is to go the download pages on the R website - a quick search for `download R’ should take you there, but if not you could try:\n\nWindows: https://cran.r-project.org/bin/windows/base/\nMac: https://cran.r-project.org/bin/macosx/\nLinux: http://cran.r-project.org/bin/linux/\n\nThe Windows and Mac version come with installer packages and are easy to install whilst the Linux binaries require use of a command terminal.\nRStudio can be downloaded from https://www.rstudio.com/products/rstudio/download/ and the free version of RStudio Desktop is more than sufficient for this module and all the other things you will to do at degree level.\nIf you experience any problems installing R or RStudio on your own computer, bring it to one of the class lab sessions where we will be able to provide advice.\n\n\n1.2.2 File management\nBefore you start installing software or downloading data, create a folder on your M-Drive (if working on a University networked machine) or locally if working on your own device – name this ‘ENVS162’ and within this create a sub-folder for each practical session. For this session, create a sub-folder called Week1 in your ENVS162 folder on your M-Drive. Take care to ensure you do not delete any work you do complete in the practical sessions. It is imperative that you practice good file management!\n\n\n1.2.3 Open RStudio\nRStudio provides an interface to the different things that R can do via the 4 panes: the Console where code is entered (bottom left), a Source pane with R scripts (top left), the variables in the working Environment (top right), Files, Plots, Help etc (bottom right) - see the RStudio environment in Figure below.\nIn the figure above of the RStudio interface, a new script has been opened, a line of code had been written and then run in the console. The code assigns a value of 100 to x. The file has been saved into the current working environment. You are expected to define a similar set up for each practical as you work through the code. Note that in the script, anything that follows a # is a comment and ignored by R.\nUsers can set up their personal preferences for how they like their RStudio interface. Similar to straight R, there are very few pull-down menus in R, and therefore you will type lines of code into your script and run these in what is termed a command line interface (the console). Like all command line interfaces, the learning curve is steep but the interaction with the software is more detailed which allows greater flexibility and precision in the specification of commands.\nBeyond this there are further choices to be made. Commands can be entered in two forms: directly into the R console window or as a series of commands into a script window. We strongly advise that all code should be written in a script - (a .R file) and then run from the script. - To run code in a script, place the cursor on the line of code and then run by pressing the ‘Run’ icon at the top left of the script pane, or by pressing Ctrl Enter (PC) (or Cmd Enter on a Mac).\n\n\n\n1.2.4 Ways of working\nThe first set of consideration relate to how you should work in R/RStudio. The key things to remember are:\n\nR is a learning curve if you have never done anything like this before. It can be scary. It can be intimidating. But once you have a bit of familiarity with how things work, it is incredibly powerful.\nYou will be working from practical worksheets which will have all the code you need. Your job is to try to understand what the code is doing and not to remember the code. Comments in your code really help.\nTo help you do this, the very strong suggestion is use the R scripts that are provided, and that you add your own comments to help you understand what is going on when you return to them. Comments are prefaced by a hash (#) that is ignored by R. Then you can save your code (with comments), run it and return to it later and modify at your leisure.\n\nThe module places a strong emphasis placed on learning by doing, which means that you encouraged to unpick the code that you are given, adapt it and play with it. It is not about remembering or being able to recall each function used but about understanding what is being done. If you can remember what you did previously (i.e. the operations you undertook) and understand what you did, you will be able to return to your code the next time you want to do something similar. To help you with this you should:\n\nAlways run your code from an R script… always! These are provided for each practical;\nAnnotate you scripts with comments. These are prefixed by a hash (#) in the code;\nSave your R script to your folder.\n\n\nIn Summary:\n\nYou should always use a script (a text file containing code) for your code which can be saved and then re-run at a later date.\nYou can write your own code into a script, copy and paste code into it or use an existing script (for example as provided for each of the R/RStudio practicals in this module).\nTo open a new R script go to File &gt; New File &gt; R Script to open a new R file, and save it with a sensible name.\nTo load an existing script file go to File &gt; Open File and then navigate to your file. Or, if you have recently opened the file, go to File &gt; Recent Files &gt;.\nIt is good practice to set the working directory at the beginning of your R session. This can be done via the menu in RStudio Session &gt; Set Working Directory &gt; …. This points the R session to the folder you choose and will ensure that any files you wish to read, write or save are placed in this directory.\nTo run code in a script, place the cursor on the line of code and then run by pressing the ‘Run’ icon at the top left of the script pane, or by pressing Ctrl Enter (PC) or Cmd Enter (Mac).\n\n\n\n\n1.2.5 Your first R code\nIn this section you will undertake a few generic operations. You will:\n\nundertake assignment: the allocation of values to an R object.\nuse assignment to create a vector of elements and a matrix of elements.\nundertake operations on R objects.\napply some functions to R objects (functions nearly always return a value).\naccess some of R in-built data to examine a data table (or data.frame which is like an Excel spreadsheet).\ndo some basic plotting, including scatter plots and histograms.\ncreate data summaries.\n\nOn the way you will also be introduced to indexing.\nFirst, you should create a new R script (see above) and save it as week1.R in the working directory you are using for this practical. This should be the Week1 sub-directory you created in the ENVS162 folder. Note that you should create a separate folder for each week’s practical.\n\n1.2.5.1 Assignment\nThe command line prompt in the Console window, the &gt;, is an invitation to start typing in your commands.\nWrite the following into your script: 3+5 and run it. Recall that code is run done by either by pressing the Run icon at the top left of the script pane, or by pressing Ctrl Enter (PC) or Cmd Enter (Mac).\n\n3+5\n\n[1] 8\n\n\nHere the result is 8. The [1] that precedes the output it formally indicates, first requested element will follow. In this case there is just one element. The &gt; indicates that R is ready for another command.\nNow type the following in to your script and run it:\n\ny &lt;- 3+5\ny\n\n[1] 8\n\n\nHere the value of the 3+5 has been assigned to y. The syntax y &lt;- 3+5 can be read as y gets 3+5. When y is invoked its value is returned (8).\nFor the purposes of this module, in R the equals sign (=) is the same as &lt;-, a left diamond bracket &lt; followed by a minus sign -. This too is interpreted by R as is assigned to or gets when the code is read right to left.\nNow copy and paste the following into your R script and run both lines:\n\nx &lt;- matrix(c(1,2,3,4,5,6,7,8), nrow = 4)\ny = matrix(1:8, nrow = 4, byrow = T)\n\nYou should see the x appear with the y in the Environment pane. y has now been overwritten with a new assignment. If you click on the icon next to them, you will get a ‘spreadsheet’ view of the data you have created.\nOf course you can also enter the following in the console and see what is returned:\n\nx\n\n     [,1] [,2]\n[1,]    1    5\n[2,]    2    6\n[3,]    3    7\n[4,]    4    8\n\ny\n\n     [,1] [,2]\n[1,]    1    2\n[2,]    3    4\n[3,]    5    6\n[4,]    7    8\n\n\nNote In the code snippets above you have used parentheses - round brackets. Different kinds of brackets are used in different ways in R. Parentheses are used with functions, and contain the arguments that are passed to the function, separated by commas (,).\nIn this case the functions are c() and matrix(). The function c() combines or concatenates elements into a vector, and matrix() creates a matrix of elements in a tabular format.\nIn the line of code x = matrix(c(1,2,3,4,5,6,7,8), nrow = 4), the arguments passed to the matrix() function are the vector of values c(1,2,3,4,5,6,7,8) and nrow = 4. Other kinds of brackets are used in different ways as you will see later.\nOne final thing to note is that the matrix is y is has the numbers 1 to 8, but this is specified by 1:8. Try entering 3:65, 19:11, and 1.5:5 to see how the colon (:) works in this context.\n\n\n1.2.5.2 Operations\nNow you can undertake operations on R objects and apply functions to them. Write the following code into your script and then run it:\n\n# x is a matrix\nx\n\n     [,1] [,2]\n[1,]    1    5\n[2,]    2    6\n[3,]    3    7\n[4,]    4    8\n\n# multiplication\nx*2\n\n     [,1] [,2]\n[1,]    2   10\n[2,]    4   12\n[3,]    6   14\n[4,]    8   16\n\n# sum of x\nsum(x)\n\n[1] 36\n\n# mean of x\nmean(x)\n\n[1] 4.5\n\n\nOperations can be undertaken directly using mathematical notation like * for multiplication or using functions like max to find the maximum value in an R object.\n\n\n1.2.5.3 Functions\nFunctions are always followed by parenthesis (round brackets) ( ). These are different from square and curly brackets [ ] and { }. Functions always return something, a result if you like, and have the generic form:\n\n# don't run this or write this into your script!\nresult = function(value or R object, other parameters)\n\nDo not run or enter this code in your script - it is an example!\n\n\n1.2.5.4 Data Tables\nHere we will load a data table in data.frame (like a spreadsheet) in R/RStudio. R has number of in-built datasets that we can use the code below loads one of these:\n\ndata(mtcars)\nclass(mtcars)\n\n[1] \"data.frame\"\n\n\nHave a look at what is loaded by listing the objects in the current R session\n\nls()\n\n[1] \"mtcars\" \"x\"      \"y\"     \n\n\nYou should see the mtcars object. You can examine this data in a number of ways\n\n# the structure of mtcars\nstr(mtcars)\n\n'data.frame':   32 obs. of  11 variables:\n $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...\n $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...\n $ disp: num  160 160 108 258 360 ...\n $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...\n $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...\n $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...\n $ qsec: num  16.5 17 18.6 19.4 17 ...\n $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...\n $ am  : num  1 1 1 0 0 0 0 0 0 0 ...\n $ gear: num  4 4 4 3 3 3 3 4 4 4 ...\n $ carb: num  4 4 1 1 2 1 4 2 2 4 ...\n\n\n\n# the first six rows (or head) of mtcars\nhead(mtcars)\n\n                   mpg cyl disp  hp drat    wt  qsec vs am gear carb\nMazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2\nValiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1\n\n\nThe mtcars object is a data.frame, a kind of data table, and it has a number of attributes which are all numeric. The code below prints it all out to the console:\n\nmtcars\n\n                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb\nMazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2\nValiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1\nDuster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4\nMerc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2\nMerc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2\nMerc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4\nMerc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4\nMerc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3\nMerc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3\nMerc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3\nCadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4\nLincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4\nChrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4\nFiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1\nHonda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2\nToyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1\nToyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1\nDodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2\nAMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2\nCamaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4\nPontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2\nFiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1\nPorsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2\nLotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2\nFord Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4\nFerrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6\nMaserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8\nVolvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2\n\n\nData frames are ‘flat’ in that they typically have a rectangular layout like a spreadsheet, with rows typically relating to observations (individuals, areas, people, houses, etc) and columns relating to their properties or attributes (height, age, etc). The columns in data frames can be of different types: vectors of numbers, factors (classes) or text strings. In matrices all of the columns have to be off the same type. Data frames are central to what we will do in R.\n\n\n1.2.5.5 Plotting the data: ‘Hello World!’\nThe code below creates a plot of 2 variables counts in the data: mpg and disp.\n\nplot(disp ~ mpg,  data = mtcars, pch=16)\n\n\n\n\n\n\n\n\nThe option pch=16 sets the plotting character to a solid black dot. More plot characters are available - examine the help for points() to see these (For any command, if you are the first time use it, you can always ask R to explain to you by using ? as help)\n\n?points\n\nThis plot can be improved greatly. We can specify more informative axis labels, change size of the text and of the plotting symbol, and so on.\nWe can also specify the same plot by passing named variables to the plot function directly as well as other parameters, as in the figure. Notice how the syntax for this is different to the plot function above, and the different parameters that are passed to the plot() function:\n\nplot(x = mtcars$mpg, y = mtcars$disp,   pch = 1, col = \"dodgerblue\", \n     cex = 1.5, xlab = \"Miles per Gallon\", ylab = \"Displacement\", \n     main = \"Hello World!\")\n\n\n\n\n\n\n\n\nNotice how the dollar sign ($) is used to access variables in the mtcars data table compared to the first plot command, which specified data = mtcars.\n\n\n1.2.5.6 Data summaries and indexing\nWe may for example require information on variables in mtcars. The summary function is very useful:\n\nsummary(mtcars)\n\n      mpg             cyl             disp             hp       \n Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  \n 1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  \n Median :19.20   Median :6.000   Median :196.3   Median :123.0  \n Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  \n 3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  \n Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  \n      drat             wt             qsec             vs        \n Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  \n 1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  \n Median :3.695   Median :3.325   Median :17.71   Median :0.0000  \n Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  \n 3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  \n Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  \n       am              gear            carb      \n Min.   :0.0000   Min.   :3.000   Min.   :1.000  \n 1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  \n Median :0.0000   Median :4.000   Median :2.000  \n Mean   :0.4062   Mean   :3.688   Mean   :2.812  \n 3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  \n Max.   :1.0000   Max.   :5.000   Max.   :8.000  \n\n\nThis shows different summaries of the individual attributes in mtcars.\nThe main R graphics function is plot(). In addition to plot() there are functions for adding points and lines to existing graphs, for placing text at specified positions, for specifying tick marks and tick labels, for labelling axes, and so on.\nThere are various other alternative helpful forms of graphical summary. A helpful graphical summary for the mtcars data frame is the scatterplot matrix.\n\n# return the names of the mtcars variables\nnames(mtcars)\n\n [1] \"mpg\"  \"cyl\"  \"disp\" \"hp\"   \"drat\" \"wt\"   \"qsec\" \"vs\"   \"am\"   \"gear\"\n[11] \"carb\"\n\n\n\n# return the 3rd to 7th names\nnames(mtcars)[c(3:7)]\n\n[1] \"disp\" \"hp\"   \"drat\" \"wt\"   \"qsec\"\n\n\n\n# check what this does\nc(3:7)\n\n[1] 3 4 5 6 7\n\n\n\n# plot the 3rd to 7th variables in mtcars\nplot(mtcars[, c(3:7)], cex = 0.5, \n     col = \"red\", upper.panel=panel.smooth)\n\n\n\n\n\n\n\n\nThe results show the correlations between the variables in the mtcars data frame, and the trend of their relationship is included with the upper.panel=panel.smooth parameter passed to plot.\nThere are number of things to notice here (as well as the figure). In particular note the use of the vector c(2:7) to subset the columns of mtcars:\n\nIn the second line, this is was used to subset the vector of column names created by names(mtcars).\nIn the third line, it was printed out. Notice how 3:7 printed out all the number between 3 and 7 - very useful.\nFor the plot, the vector was passed to the second argument, after the comma, in the square brackets [,] to indicate which columns were to be plotted.\n\nThe referencing in this way (or indexing) is very important: the individual rows and columns of 2 dimensional data structures like data frames, matrices, tibbles etc can be accessed by passing references to them in the square brackets.\n\n# 1st row\nmtcars[1,]\n\n          mpg cyl disp  hp drat   wt  qsec vs am gear carb\nMazda RX4  21   6  160 110  3.9 2.62 16.46  0  1    4    4\n\n# 3rd column\nmtcars[,3]\n\n [1] 160.0 160.0 108.0 258.0 360.0 225.0 360.0 146.7 140.8 167.6 167.6 275.8\n[13] 275.8 275.8 472.0 460.0 440.0  78.7  75.7  71.1 120.1 318.0 304.0 350.0\n[25] 400.0  79.0 120.3  95.1 351.0 145.0 301.0 121.0\n\n# a selection of rows\nmtcars[c(3:5,8),]\n\n                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb\nDatsun 710        22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive    21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2\nMerc 240D         24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2\n\n\nSuch indexing could of course have been assigned to a R object and used to do the subsetting:\n\nx = c(3:7)\nnames(mtcars)[x]\n\n[1] \"disp\" \"hp\"   \"drat\" \"wt\"   \"qsec\"\n\n\nThus indexing allows specific rows and columns to be extracted from the data as required.\nNote You have encountered a second type of brackets, square brackets [ ]. These are used to reference or index positions in a vector or a data table.\nConsider the object x above. It contains a vector of values, 3,4,5,6,7. Entering x[1] would extract the first element of x, in this case 3. Similarly x[4] would return the 4th element and x[c(1,4)] would return the 1st and 4th elements of x.\nHowever, in the examples above that index the 2-dimensional mtcars object, the square brackets are used to index row and column positions. The syntax for this is [rows, columns]. We will be using such indexing throughout this module.\nYou can ask R to return you specific rows and columns by different ways:\n\nmtcars[c(2,9), 3:7]\n\n               disp  hp drat    wt  qsec\nMazda RX4 Wag 160.0 110 3.90 2.875 17.02\nMerc 230      140.8  95 3.92 3.150 22.90\n\nmtcars[3:6, c(\"disp\",\"hp\",\"qsec\")]\n\n                  disp  hp  qsec\nDatsun 710         108  93 18.61\nHornet 4 Drive     258 110 19.44\nHornet Sportabout  360 175 17.02\nValiant            225 105 20.22\n\nmtcars [, c(\"wt\",\"gear\",\"cyl\")]\n\n                       wt gear cyl\nMazda RX4           2.620    4   6\nMazda RX4 Wag       2.875    4   6\nDatsun 710          2.320    4   4\nHornet 4 Drive      3.215    3   6\nHornet Sportabout   3.440    3   8\nValiant             3.460    3   6\nDuster 360          3.570    3   8\nMerc 240D           3.190    4   4\nMerc 230            3.150    4   4\nMerc 280            3.440    4   6\nMerc 280C           3.440    4   6\nMerc 450SE          4.070    3   8\nMerc 450SL          3.730    3   8\nMerc 450SLC         3.780    3   8\nCadillac Fleetwood  5.250    3   8\nLincoln Continental 5.424    3   8\nChrysler Imperial   5.345    3   8\nFiat 128            2.200    4   4\nHonda Civic         1.615    4   4\nToyota Corolla      1.835    4   4\nToyota Corona       2.465    3   4\nDodge Challenger    3.520    3   8\nAMC Javelin         3.435    3   8\nCamaro Z28          3.840    3   8\nPontiac Firebird    3.845    3   8\nFiat X1-9           1.935    4   4\nPorsche 914-2       2.140    5   4\nLotus Europa        1.513    5   4\nFord Pantera L      3.170    5   8\nFerrari Dino        2.770    5   6\nMaserati Bora       3.570    5   8\nVolvo 142E          2.780    4   4\n\n\n\n\n1.2.5.7 Packages\nThe base installation of R includes many functions and commands. However, more often we are interested in using some particular functionality, encoded into packages contributed by the R developer community. Installing packages for the first time can be done at the command line in the R console using the install.packages command as in the example below to install the tmap library or via the RStudio menu via Tools &gt; Install Packages.\nWhen you install these packages it is strongly suggested you also install the dependencies. These are other packages that are required by the package that is being installed. This can be done by selecting check the box in the menu or including dep=TRUE in the command line as below (don’t run this yet!):\n\n# don't run this!\ninstall.packages(\"tidyverse\", dep = TRUE)\n\nYou may have to set a mirror site from which the packages will be downloaded to your computer. Generally you should pick one that is nearby to you.\nFurther descriptions of packages, their installation and their data structures will be given as needed in the practicals. There are literally 1000s of packages that have been contributed to the R project by various researchers and organisations. These can be located by name at http://cran.r-project.org/web/packages/available_packages_by_name.html if you know the package you wish to use. It is also possible to search the CRAN website to find packages to perform particular tasks at http://www.r-project.org/search.html. Additionally many packages include user guides and vignettes as well as a PDF document describing the package and listed at the top of the index page of the help files for the package.\nAs well as tidyverse you should install the sf package and dependencies. So we have 2 packages to install:\n\nsf for spatial data and spatial objects\ntidyverse for lots of lovely data science things - see https://www.tidyverse.org\n\nYou could do this in one go and this will take a bit of time:\n\ninstall.packages(c(\"sf\", \"tidyverse\"), dep = TRUE)\n\nRemember: you will only have to install a package once!! So when the above code has run in your script you should comment it out. For example you might want to include something like the below in your R script.\n\n# packages only need to be loaded once\n# install.packages(c(\"sf\", \"tidyverse\"), dep = TRUE)\n\nOnce the package has been installed on your computer then the package can be called using the library() function into each of your R sessions as below.\n\nlibrary(tidyverse)\nlibrary(sf)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab: Getting Started in RStudio - Knowing Merseyside</span>"
    ]
  },
  {
    "objectID": "labs/01.GettingStartedinRStudio.html#knowing-merseyside",
    "href": "labs/01.GettingStartedinRStudio.html#knowing-merseyside",
    "title": "1  Lab: Getting Started in RStudio - Knowing Merseyside",
    "section": "1.3 Knowing Merseyside",
    "text": "1.3 Knowing Merseyside\n\n1.3.1 Merseyside districts\nNow we use these basic R command and newly installed packages to start our initial exploration by using some existing secondary dataset from the Census 2021.\nIn R we normally read in tabular dataset from .csv format. In your ENVS162 Canvas page find Week 1 -&gt; Practical 1 Dataset, download the four datasets to your current working folder on your M drive (ENVS162 - Week 1). You may first identify one .csv dataset: merseyside.csv. You can open them in excel to have a look, but here we are using R instead of Excel to load and examine them.\n\n1.3.1.1 Loading tabular data\nThe survey data can be loaded into RStudio using the read.csv function.\nHowever, you will need to tell R where to get the data from. The easiest way to do this is to use the menu if the R script file is open. Go to Session &gt; Set Working Directory &gt; To Source File Location to set the working directory to the location where your week1.R script is saved. When you do this you will see line of code print out in the Console (bottom left pane) similar to setwd(\"SomeFilePath\"). You can copy this line of code to your script and paste into the line above the line calling the read.csv function.\n\n# use read.csv to load a CSV file\n# this is assignment to an object called `df`\ndf = read.csv(file = \"merseyside.csv\", stringsAsFactors = TRUE)\n\nThe stringsAsFactors = TRUE parameter tells R to read any character or text variables as classes or categories and not as just text.\nYou could inspect the help for the read.csv function to see the different parameters and their default values:\n\nhelp(read.csv)\n\nstarting httpd help server ... done\n\n# or \n?read.csv\n\nFunctions always return something and in this case read.csv() function has returned a tabular R object with 5 records and 12 fields. This has been assigned to df.\nFinally in this section, lets have a look at the data. This can be done in a number of ways.\n\nyou could look at the df object by entering df in the Console. However this is not particular helpful as it simply prints out everything that is in df to the Console.\nyou could click on the df object in the Environment pane and this shows the structure of the attributes in different fields.\nyou could click on the little grid-like icon next df in the Environment pane to get a View of the data and remember to close the tab that opens!.\nor you could use some code as in the examples below.\n\nFirst, let’s have a look at the internal structure of the data using the str function:\n\nstr(df)\n\n'data.frame':   5 obs. of  12 variables:\n $ LAD21CD           : Factor w/ 5 levels \"E08000011\",\"E08000012\",..: 1 2 3 4 5\n $ District          : Factor w/ 5 levels \"Knowsley\",\"Liverpool\",..: 1 2 4 3 5\n $ Population        : int  154519 486089 183248 279234 320196\n $ Households        : int  66073 207491 81011 123075 143253\n $ Working_population: int  69495 205749 82622 124596 139500\n $ Students          : int  7050 59628 7582 12636 14642\n $ Unemployed        : int  3852 13894 4076 6143 6542\n $ Age_over_65       : int  26242 74322 37642 64763 70391\n $ Disability        : int  34990 105962 40829 61134 73088\n $ No_central_heating: int  1020 4822 1003 1965 2125\n $ Overcrowding      : int  1892 7352 1888 2700 2355\n $ Working_from_home : int  14880 53721 18973 34750 37299\n\n\nThere is other ways to get info about the number of rows and columns:\n\nnrow(df)\n\n[1] 5\n\nncol(df)\n\n[1] 12\n\n#or both row and col\ndim(df)\n\n[1]  5 12\n\n\nThe head function does this by printing out the first six records of the data table and you may need to scroll up and down in the Console pane to see all of what is returned.\n\nhead(df)\n\n    LAD21CD   District Population Households Working_population Students\n1 E08000011   Knowsley     154519      66073              69495     7050\n2 E08000012  Liverpool     486089     207491             205749    59628\n3 E08000013 St. Helens     183248      81011              82622     7582\n4 E08000014     Sefton     279234     123075             124596    12636\n5 E08000015     Wirral     320196     143253             139500    14642\n  Unemployed Age_over_65 Disability No_central_heating Overcrowding\n1       3852       26242      34990               1020         1892\n2      13894       74322     105962               4822         7352\n3       4076       37642      40829               1003         1888\n4       6143       64763      61134               1965         2700\n5       6542       70391      73088               2125         2355\n  Working_from_home\n1             14880\n2             53721\n3             18973\n4             34750\n5             37299\n\n\nAnother way to explore the data is through the summary function:\n\nsummary(df)\n\n      LAD21CD        District   Population       Households    \n E08000011:1   Knowsley  :1   Min.   :154519   Min.   : 66073  \n E08000012:1   Liverpool :1   1st Qu.:183248   1st Qu.: 81011  \n E08000013:1   Sefton    :1   Median :279234   Median :123075  \n E08000014:1   St. Helens:1   Mean   :284657   Mean   :124181  \n E08000015:1   Wirral    :1   3rd Qu.:320196   3rd Qu.:143253  \n                              Max.   :486089   Max.   :207491  \n Working_population    Students       Unemployed     Age_over_65   \n Min.   : 69495     Min.   : 7050   Min.   : 3852   Min.   :26242  \n 1st Qu.: 82622     1st Qu.: 7582   1st Qu.: 4076   1st Qu.:37642  \n Median :124596     Median :12636   Median : 6143   Median :64763  \n Mean   :124392     Mean   :20308   Mean   : 6901   Mean   :54672  \n 3rd Qu.:139500     3rd Qu.:14642   3rd Qu.: 6542   3rd Qu.:70391  \n Max.   :205749     Max.   :59628   Max.   :13894   Max.   :74322  \n   Disability     No_central_heating  Overcrowding  Working_from_home\n Min.   : 34990   Min.   :1003       Min.   :1888   Min.   :14880    \n 1st Qu.: 40829   1st Qu.:1020       1st Qu.:1892   1st Qu.:18973    \n Median : 61134   Median :1965       Median :2355   Median :34750    \n Mean   : 63201   Mean   :2187       Mean   :3237   Mean   :31925    \n 3rd Qu.: 73088   3rd Qu.:2125       3rd Qu.:2700   3rd Qu.:37299    \n Max.   :105962   Max.   :4822       Max.   :7352   Max.   :53721    \n\n\nFinally in this section, we come back to the dollar sign ($). This is used to refer to or extract an individual named field or variable in an R object, like df.\nThe code below prints out the Population attribute and generates a summary of its values:\n\n# extract an individual variable\ndf$Population\n\n[1] 154519 486089 183248 279234 320196\n\n\n\n# generate a summary of an individual variable\nsummary(df$Population)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 154519  183248  279234  284657  320196  486089 \n\n\nAnd of course we can use such operations to assign the result to new R objects. The code below extracts three variables from df, assigns them to x, y and z, and then uses the data.frame function to convert these into a new data.frame object called my_df\n\n# extract three variables, assigning them to temporary R objects\nx = df$District\ny = df$Working_population\nz = df$Students\n# create a data.frame from these, naming the new variables\nmy_df = data.frame(district = x,worker = y,student = z)\n\nYou should have a look at what you have created:\n\nhead(my_df)\n\n    district worker student\n1   Knowsley  69495    7050\n2  Liverpool 205749   59628\n3 St. Helens  82622    7582\n4     Sefton 124596   12636\n5     Wirral 139500   14642\n\n\n\nsummary(my_df)\n\n       district     worker          student     \n Knowsley  :1   Min.   : 69495   Min.   : 7050  \n Liverpool :1   1st Qu.: 82622   1st Qu.: 7582  \n Sefton    :1   Median :124596   Median :12636  \n St. Helens:1   Mean   :124392   Mean   :20308  \n Wirral    :1   3rd Qu.:139500   3rd Qu.:14642  \n                Max.   :205749   Max.   :59628  \n\n\nThe temporary R objects can be removed from the Environment using the rm function and a combine vector function, c() that you encountered in Week 19, that takes a vector of object names (hence they are in quotes) as its arguments.\n\nrm(list = c(\"x\",\"y\",\"z\"))\n\n\n\n1.3.1.2 Basic data manipulation\nNow we can do some basic data manipulation to know Merseyside more from the data perspective.\nWhat is the total population in Merseyside?\n\nsum(df$Population)\n\n[1] 1423286\n\n\nWhat is the total number of full-time students in Merseyside?\n\nsum(df$Students)\n\n[1] 101538\n\n\nThen, we can calculate the total number of workers that working from home:\n\nsum(df$Working_from_home)\n\n[1] 159623\n\n\nWhat is the proportion of working population actually work from home in Merseyside? Yes, we need to use a division calculation of the total number of working from home vs. all the working population. R can do it by:\n\nsum(df$Working_from_home) / sum(df$Working_population)\n\n[1] 0.2566443\n\n\nSo the answer is 25.7% for the whole Merseyside - but which district has the highest proportion and which as the lowest? You may have your own guessing. But let R do the calculation:\n\ndf$Prop.WFH = df$Working_from_home / df$Working_population * 100 #add a new column called Prop.WFH\ndf #print out the df\n\n    LAD21CD   District Population Households Working_population Students\n1 E08000011   Knowsley     154519      66073              69495     7050\n2 E08000012  Liverpool     486089     207491             205749    59628\n3 E08000013 St. Helens     183248      81011              82622     7582\n4 E08000014     Sefton     279234     123075             124596    12636\n5 E08000015     Wirral     320196     143253             139500    14642\n  Unemployed Age_over_65 Disability No_central_heating Overcrowding\n1       3852       26242      34990               1020         1892\n2      13894       74322     105962               4822         7352\n3       4076       37642      40829               1003         1888\n4       6143       64763      61134               1965         2700\n5       6542       70391      73088               2125         2355\n  Working_from_home Prop.WFH\n1             14880 21.41161\n2             53721 26.10997\n3             18973 22.96362\n4             34750 27.89014\n5             37299 26.73763\n\n\nHere we ask R to add a new column named Prop.WFH which is the working from home proportion that calculated by the number of working from home people in each district divided by the total working population in that district. The * 100 convert the rate in the percentage number. R will automatically do it row-by-row. We then print out the df, you may find at the very right end of the tabular, there is a new column called Prop.WFH.\nFor a very small dataframe like this, we can also using View() to open a new tab to review the data, where each column can be sorted from largest to smallest or vice versa. Try viewing it and find the newly created column Prop.WFH. Click on the column name, you should see it is sorted from highest to lowest, and click again, the ranking is reversed.\n\nView(df)\n\n\n\n1.3.1.3 Your first map for Merseyside\nNow let’s try to do our first map in R and allow yourself know more about Merseyside.\nWe will use the library sf and tmap to help us at here. Run the install codes if you haven’t install them. Remember: you will only have to install a package once!!\n\ninstall.packages(\"tmap\",dep =TRUE)\n\nCheck the package version of tmap, as here we need to use tmap over 4.0 version.\n\npackageVersion(\"tmap\") # the version should over 4.0\n\n[1] '4.1'\n\n\nWhen they have been installed, we can start using them\n\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(tmap)\n\nYou may find in Week 1 data, we have another file named merseyside_districts.gpkg. A GeoPackage (GPKG) is a file-based format designed for storing geographic data. It supports the efficient storage and exchange of spatial datasets and can be readily used across GIS software such as QGIS and ArcGIS, as well as in programming environments including R and Python.\nWe first read it in by using the st_read() command in library sf.\n\nsf &lt;- st_read(\"merseyside_districts.gpkg\")\n\nReading layer `lad_may_2025_uk_bgc_v2_4306843991635065087__lad_may_2025_uk_bgc_v2' from data source `C:\\Users\\ziye\\Documents\\GitHub\\quant\\labs\\merseyside_districts.gpkg' \n  using driver `GPKG'\nSimple feature collection with 5 features and 8 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 318351.7 ymin: 377515.4 xmax: 361796.3 ymax: 422866.5\nProjected CRS: OSGB36 / British National Grid\n\n\nThe fastest way to map it is the qtm() function.\n\nqtm(sf)\n\n\n\n\n\n\n\n\nYou can also add the district names on the map - which column in the sf contains district name? Use names(sf) to check for it.\nYes, the column should be LAD25NM. Now let’s ask qtm() to also show the district names.\n\nqtm(sf,text=\"LAD25NM\")\n\n\n\n\n\n\n\n\nBut what if we want to make some meaningful maps, rather than just the boundaries of these five districts of Merseyside?\n\n\n1.3.1.4 Link tabular data to geographical boundaries\nRecall that in our df, we have 14 columns, containing different information about the districts. We can get all their names by using names().\n\nnames(df)\n\n [1] \"LAD21CD\"            \"District\"           \"Population\"        \n [4] \"Households\"         \"Working_population\" \"Students\"          \n [7] \"Unemployed\"         \"Age_over_65\"        \"Disability\"        \n[10] \"No_central_heating\" \"Overcrowding\"       \"Working_from_home\" \n[13] \"Prop.WFH\"          \n\n\nWe can do the same thing for our geographical dataset sf to see what it includes:\n\nnames(sf)\n\n[1] \"LAD25CD\"  \"LAD25NM\"  \"LAD25NMW\" \"BNG_E\"    \"BNG_N\"    \"LONG\"     \"LAT\"     \n[8] \"GlobalID\" \"geom\"    \n\n\nWe can also show the whole sf as\n\nsf\n\nSimple feature collection with 5 features and 8 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 318351.7 ymin: 377515.4 xmax: 361796.3 ymax: 422866.5\nProjected CRS: OSGB36 / British National Grid\n    LAD25CD    LAD25NM LAD25NMW  BNG_E  BNG_N      LONG      LAT\n1 E08000011   Knowsley          344762 393778 -2.832979 53.43789\n2 E08000012  Liverpool          339359 390556 -2.913680 53.40833\n3 E08000013 St. Helens          353413 395992 -2.703093 53.45862\n4 E08000014     Sefton          334282 398835 -2.991771 53.48213\n5 E08000015     Wirral          329109 386965 -3.067034 53.37478\n                                GlobalID                           geom\n1 {B4196BFE-EE90-4C31-ABD5-C7E743AE2F9B} MULTIPOLYGON (((341447.1 40...\n2 {4FB47E7A-EF4E-4B9E-BF75-D4FC059CDE61} MULTIPOLYGON (((338860.9 39...\n3 {943F0C6B-EB30-4C00-A42B-F6B3AEC3EFEE} MULTIPOLYGON (((349111.4 40...\n4 {C6FD073B-CBEB-4E78-934A-A8FD11A20F0A} MULTIPOLYGON (((336374.5 42...\n5 {88E9328B-371C-469C-91F1-3479C77D6950} MULTIPOLYGON (((331364.9 39...\n\n\nNow we see that sf includes also the five districts, but also other geographical information. You may notice that although different column names, the first two columns of both df and sf are the district code and district name. This means what potentially we can link this two dataset together - appendix the df to sf to enrich the attributes of our geographical dataset.\n\nmerseyside &lt;- left_join(sf, df,by=c(\"LAD25NM\"=\"District\"))\n\nlet’s check out the new sf2 by View() it:\n\nView(merseyside)\n\nIn the open tab, we see all the df columns are now also attached to the sf, linking by the district names.\n\n\n1.3.1.5 Choropleth map of Merseyside districts\nNow, we can use those new columns we attached from df to sf2 to make some meaningful choropleth maps! Here we make use of the mapping functions in tmap (Remember to run library(tmap) if you haven’t) to do the work for us.\ntmap has a basic syntax (again, do not run this code - its is simply showing the syntax of tmap):\n\n# don't run this or write this into your script!\ntm_shape(data = &lt;data&gt;)+\n  tm_&lt;function&gt;(&lt;variable to be mapped&gt;)\n\nFor example, to map the boundaries of merseyside:\n\ntm_shape(merseyside) + \n  tm_borders()\n\n\n\n\n\n\n\n\nTo add label of district:\n\ntm_shape(merseyside) + \n  tm_borders() + \n  tm_text(\"LAD25NM\")\n\n\n\n\n\n\n\n\nYou might assume the quick mapping function qtm() can achieve the same result, but tmap provides far more flexibility when it comes to aesthetic customization. The easiest way to illustrate tmap is through some examples.\nLet’s start with a simple choropleth map, by using tmap to show the distribution of a continuous variable in different elements of the spatial data (here are the data Merseyside districts are polygons).\nThe code below maps `Students’ as in the Merseyside districts, and shows the district names of each polygon from ‘LAD25NM’ columns. The map below indicates that Liverpool has the highest number of full-time students while Knowsley and St.Helens have the least.\n\ntm_shape(merseyside) + \n  tm_polygons(fill = \"Students\") +   # Variable to map \n  tm_text(\"LAD25NM\")                 # Variable to label\n\n\n\n\n\n\n\n\nBy default tmap picks a shading scheme, the class breaks and places a legend somewhere. All of these can be changed. The code below allocates the tmap plot to map1 (Map 1), change the legend title as “Number of students in Merseyside districts”, and then prints it:\n\nmap1  = tm_shape(merseyside) + \n  tm_polygons(fill=\"Students\",\n              fill.scale = tm_scale(values = \"Greens\"), # change palette to greens\n              fill.legend = tm_legend(title = \"Number of students in Merseyside districts\")\n              ) +# Legend title\n  tm_text(\"LAD25NM\",size=0.8) #size down the label slightly\nmap1\n\n\n\n\n\n\n\n\nAnd of course many other elements included either by running the code snippet defining map1 above with additional lines or by simply adding them as in the code below:\n\nmap1 + \n  tm_scalebar(position = c(\"right\", \"bottom\")) + \n  tm_compass(position = c(\"left\", \"top\"))  # Use \"top\", \"center\", or \"bottom\"\n\n\n\n\n\n\n\n\nWe can also create new variable to the dataset and then map it. The below code chunk first creates a new column, “NoCentralHeating_rate”, by dividing the number of households without access to central heating by the total number of households in each district; it then uses tmap to make a map of the proportion of households without central heating across districts in Merseyside:\n\nmerseyside$NoCentralHeating_rate = merseyside$No_central_heating / merseyside$Households * 100\n\nmap2 = tm_shape(merseyside) + \n  tm_polygons(fill=\"NoCentralHeating_rate\",\n              fill.scale = tm_scale(values = \"Reds\", style = \"jenks\"), #use jenks classification rather than equal\n              fill.legend = tm_legend(title = \"% No Central Heating\")) +\n  tm_text(\"LAD25NM\",size=0.8) +\n  tm_scalebar(position = c(\"right\", \"bottom\")) +  # Add a scale bar at the top-right corner\n  tm_compass(position = c(\"left\", \"top\"))  # Add a compass rose at the top-right corner\nmap2\n\n\n\n\n\n\n\n\n\n\n\n1.3.2 Merseyside neighbourhoods\nNow let’s read in the neighbourhood-level datasets, which include a .csv file of local statistics and the corresponding geographical boundaries.\n\nlsoa_df &lt;- read.csv(\"merseyside_lsoa.csv\")\nlsoa_sf &lt;- st_read(\"LSOA_boundaries.gpkg\")\n\nReading layer `merseyside_LSOA' from data source \n  `C:\\Users\\ziye\\Documents\\GitHub\\quant\\labs\\LSOA_boundaries.gpkg' \n  using driver `GPKG'\nSimple feature collection with 923 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -3.200368 ymin: 53.2963 xmax: -2.576743 ymax: 53.6982\nGeodetic CRS:  WGS 84\n\n\nFirst, we take a look at the .csv dataset, which as been read into R as lsoa_df:\n\nView(lsoa_df)\n\nor check the structure of the dataset:\n\nstr(lsoa_df)\n\n'data.frame':   923 obs. of  11 variables:\n $ LSOA21CD          : chr  \"E01006416\" \"E01006418\" \"E01006434\" \"E01006435\" ...\n $ Population        : int  1520 1315 1519 1524 1150 1654 1450 1581 1421 1373 ...\n $ Households        : int  678 567 652 663 490 695 592 622 809 618 ...\n $ Working_population: int  588 547 660 581 546 766 558 570 524 481 ...\n $ Students          : int  59 64 69 82 51 66 65 89 52 72 ...\n $ Unemployed        : num  3.57 2.74 5.11 3.43 1.62 ...\n $ Age_over_65       : num  14.8 17.5 11.7 19.9 26.3 ...\n $ Disability        : num  27.1 30 23.4 29 20.5 ...\n $ No_central_heating: int  16 14 16 7 3 8 9 9 12 9 ...\n $ Overcrowding      : int  24 24 35 28 13 21 29 23 31 22 ...\n $ Working_from_home : int  91 84 102 96 165 171 101 64 66 48 ...\n\n\nSo now, you know how many LSOAs in Merseyside? Yes, there are 923 LSOAs. As we introduced in the Week 1 lecture, LSOA means Super Output Area Lower Area and is commonly used in the Census statistics. Each LSOA represents 1,000 to 3,000 people or 400 to 1,200 households in England and Wales.\n\ndim(lsoa_df)\n\n[1] 923  11\n\n\nUse the quick mapping function qtm() to quickly inspect the geographical boundary dataset lsoa_sf .\n\nqtm(lsoa_sf)\n\n\n\n\n\n\n\n\ncheck how many LSOAs in the boundary dataset - there should also be 923.\n\nnrow(lsoa_sf)\n\n[1] 923\n\n\nTo familiarise yourself with the structures of both datasets, we can use the names() command\n\nnames(lsoa_df)\n\n [1] \"LSOA21CD\"           \"Population\"         \"Households\"        \n [4] \"Working_population\" \"Students\"           \"Unemployed\"        \n [7] \"Age_over_65\"        \"Disability\"         \"No_central_heating\"\n[10] \"Overcrowding\"       \"Working_from_home\" \n\nnames(lsoa_sf)\n\n[1] \"LSOA21CD\" \"LSOA21NM\" \"LAD23CD\"  \"LAD23NM\"  \"geom\"    \n\n\nYou may find that both dataset are recorded at the LSOA level, with LSOA21CD as the key column. As we did with the district-level dataset, we can use left_join() to join these two dataset by their sharing field - LSOA21CD:\n\nlsoa &lt;- left_join(lsoa_sf,lsoa_df,by=\"LSOA21CD\")\n\nNow let’s check the columns of new dataframe lsoa:\n\nnames(lsoa)\n\n [1] \"LSOA21CD\"           \"LSOA21NM\"           \"LAD23CD\"           \n [4] \"LAD23NM\"            \"Population\"         \"Households\"        \n [7] \"Working_population\" \"Students\"           \"Unemployed\"        \n[10] \"Age_over_65\"        \"Disability\"         \"No_central_heating\"\n[13] \"Overcrowding\"       \"Working_from_home\"  \"geom\"              \n\n\nOr open a new tab to view the newly created dataset lsoa by\n\nView(lsoa)\n\nWe can see that some columns contain counts, such as the number of residential population, number of households, number of working population, and number of students. Other columns are expressed as percentages, including unemployment, population aged 65 and over, disability, households without central heating, overcrowded households, and people working from home.\n\n1.3.2.1 Making maps across LSOAs in Merseyside\nUsing the Unemployed column, we can create a map of the unemployment rate across neighbourhoods in Merseyside. Instead of using the default equal-interval breaks, this time we will use a jenks classification with six categories.\n\nmap3 = tm_shape(lsoa) +\n  tm_fill(\n    fill = \"Unemployed\",\n    fill.scale = tm_scale(values = \"GnBu\", \n                          style = \"jenks\", \n                          n = 6), #use jenks classification of 6 categories\n    fill.legend = tm_legend(title = \"% Unemployed\")\n    ) +\n  tm_layout(legend.position = c(\"right\", \"top\"))\nmap3\n\n\n\n\n\n\n\n\nThe above code uses tm_layout(legend.position = c(\"right\", \"top\")) to move the legend inside the map frame, positioning it at the right-top corner.\n\nReplace tm_fill() to tm_polygons() to see how the map changes?\ntm_polygons() is a condense version of tm_fill() + tm_border(). Here if you want show all the LSOA borders, use tm_polygons() instead of tm_fill().\n\n\n\n1.3.2.2 Overlapping tmap objects\ntmap also supports adding or overlaying other data, such as boundaries. Because these are additional spatial data layers, they needs to be added with tm_shape() followed by the usual function.\nRemember we use the code chunk to make the district boundaries of Merseyside? This time let’s change the aesthetic by using grey color as the border color and increase the line width, then we save it also as a tmap object called map_district:\n\nmap_district = tm_shape(merseyside) + \n  tm_borders(col = \"grey50\",lwd=1.5) + #border color as grey, line width as 1.5\n  tm_text(\"LAD25NM\",size = 0.8)\nmap_district\n\n\n\n\n\n\n\n\nTo display both tmap layers together, we can proceed as follows:\n\nmap3 + map_district\n\n\n\n\n\n\n\n\nNow, let’s move to making some more maps - this time showing the proportion of disability across neighbourhoods in Merseyside. Referring back to the columns in lsoa, this time we use the Disability variable. The code below applies a jenks classification and use a different color palette Purples. Also the map frame is removed by frame = FALSE.\n\ntm_shape(lsoa) + \n  tm_fill(fill = \"Disability\",\n          fill.scale = tm_scale(values=\"Purples\", \n                                style = \"jenks\",\n                                n=5),\n          fill.legend = tm_legend(title = \"% Disability\")\n          ) +\n  tm_layout(main.title = \"Merseyside\",#add a main title\n            legend.position = c(\"right\", \"top\"),\n            frame = FALSE)+\n  map_district\n\n\n\n\n\n\n\n\n\n\n1.3.2.3 Create new variables to make maps\nSimilarly, we can make maps from new columns we made ourselves. For example, we can calculate the percentage of student by adding a new column to the dataframe:\n\nlsoa$student.perc = lsoa$Students / lsoa$Population * 100\n\nTo make a map to visualisation the spatial distribution of student percentage. The code below uses n=6 to increase the classification categories to 6 rather than default 5.\n\ntm_shape(lsoa) + \n  tm_fill(fill = \"student.perc\",\n          fill.scale = tm_scale(values=\"Blues\",\n                                style = \"jenks\",\n                                n=6),\n          fill.legend = tm_legend(title = \"% of Student\",\n                                  title.size = 0.8) #legend title change smaller font\n          ) +\n  tm_layout(main.title = \"Merseyside\",\n            frame = FALSE,\n            legend.position = c(\"right\", \"top\"))+\n  map_district\n\n\n\n\n\n\n\n\nTo change the palette, RColorBrewer provides different palette choices:\n\nRColorBrewer::display.brewer.all()\n\n\n\n\n\n\n\n\n\n\n1.3.2.4 In a nutshell\nIf we want to make a map to show the rate of no central heating households in all the neighbourhoods in Merseyside, we need to create a new variable no.central.heating.perc as the result of dividing households without central heating by total households in each LSOA. The code below combines all the cartographic elements together:\n\nlsoa$no.central.heating.perc = lsoa$No_central_heating / lsoa$Households * 100\n\ntm_shape(lsoa) + \n  tm_fill(fill = \"no.central.heating.perc\",\n          fill.scale = tm_scale(values=\"YlOrRd\",\n                                style = \"jenks\",n=6),\n          fill.legend = tm_legend(title = \"% of no central heating households\", \n                                  title.size = 0.8)\n        ) +\n  tm_layout(main.title = \"Merseyside\",\n            main.title.size=1.2,\n            frame = FALSE) + \n  tm_compass(position = c(\"right\", \"top\")) +\n  tm_scalebar(position = c(\"right\", \"bottom\")) +\n  tm_shape(merseyside) +               # Add another spatial layer (Merseyside boundary)\n  tm_borders(col = \"black\", lwd = 1) +  # Draw the boundaries with black lines of width 1\n  tm_text(\"LAD25NM\",col = \"blue\",size = 0.8)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab: Getting Started in RStudio - Knowing Merseyside</span>"
    ]
  },
  {
    "objectID": "labs/01.GettingStartedinRStudio.html#summary",
    "href": "labs/01.GettingStartedinRStudio.html#summary",
    "title": "1  Lab: Getting Started in RStudio - Knowing Merseyside",
    "section": "1.4 Summary",
    "text": "1.4 Summary\nThe aim of this session has been to familiarise you with the R environment if you have not used R before. If you have but not for a while, then hopefully this has acted as a refresher. Some key things to take away are:\n\nR is a learning curve, and like driving the more your practice the better you become.\nYour job is to try to understand what the code is doing and not to remember the code.\nTo help with this, you should add your own comments to the script to help you understand what is going on when you return to them. Comments are prefaced by a hash (#) that is ignored by R.\nAlways set your working directory to the sub-folder containing your R script.\nAlways run your code from an R script… always!\n\n\n1.4.1 References\nBrunsdon, Chris, and Lex Comber. 2018. An Introduction to r for Spatial Analysis and Mapping (2e). Sage.\nComber, Lex, and Chris Brunsdon. 2021. Geographical Data Science and Spatial Data Analysis: An Introduction in r. Sage.\nHarris, Richard. 2016. Quantitative Geography: The Basics. Sage.\nOther good on-line get started in R guides include:\n\nThe Owen guide (only up to page 28) : https://cran.r-project.org/doc/contrib/Owen-TheRGuide.pdf\nAn Introduction to R - https://cran.r-project.org/doc/contrib/Lam-IntroductionToR_LHL.pdf\nR for beginners https://cran.r-project.org/doc/contrib/Paradis-rdebuts_en.pdf",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab: Getting Started in RStudio - Knowing Merseyside</span>"
    ]
  },
  {
    "objectID": "labs/01.GettingStartedinRStudio.html#formative-tasks",
    "href": "labs/01.GettingStartedinRStudio.html#formative-tasks",
    "title": "1  Lab: Getting Started in RStudio - Knowing Merseyside",
    "section": "1.5 Formative Tasks",
    "text": "1.5 Formative Tasks\nTask 1 From the district level dataset “merseyside.csv”, extract household information for the Liverool and Wirral districts. The variables to be included are “Households”, “No_central_heating” and “Overcrowding”.\n\ndf &lt;- read.csv(\"merseyside.csv\")  \ndf[c(2,5),c(\"Households\",\"No_central_heating\",\"Overcrowding\")]\n\n  Households No_central_heating Overcrowding\n2     207491               4822         7352\n5     143253               2125         2355\n\n\nTask 2 Use the dataset “merseyside_lsoa.csv”, plot the Disability against Age_over_65 from the data frame.\n\nlsoa_df &lt;- read.csv(\"merseyside_lsoa.csv\") \nplot(Disability~Age_over_65, data = lsoa_df) \n\n\n\n\n\n\n\n# or \nplot(lsoa_df$Disability, lsoa_df$Age_over_65)\n\n\n\n\n\n\n\n\nTask 3 Use the district level dataset, how many households in total in Merseyside?\nTask 4 Use the district level dataset, what is the overall proportion of the ageing population (age over 65) in Merseyside?\n\nsum(df$Age_over_65)/sum(df$Population)\n\n[1] 0.1920626\n\n\nTask 5 Use the LSOA level dataset, what is the average proportion of the ageing population (age over 65) across all the neighbourhoods of Merseyside?\n\ndf$ageing_rate = df$Age_over_65 / df$Population * 100\nmean(df$ageing_rate)\n\n[1] 19.59824\n\n\nTask 6 Create a map showing the spatial distribution of the proportion of ageing population (age over 65) over LSOAs in Merseyside? (use Jenks classification of 7 categories).\n\nlsoa$ageing_rate = lsoa$Age_over_65 / lsoa$Population * 100\n\ntm_shape(lsoa) + \n  tm_fill(fill = \"ageing_rate\",\n          fill.scale = tm_scale(values=\"PuRd\",style = \"jenks\",n=7),\n          fill.legend = tm_legend(title = \"% Age over 65\", title.size = 0.8)\n        ) +\n  tm_layout(main.title = \"Merseyside\",\n            main.title.size=1.2,\n            frame = FALSE) + \n  tm_compass(position = c(\"right\", \"top\")) +\n  tm_scalebar(position = c(\"right\", \"bottom\")) +\n  tm_shape(merseyside) +               # Add another spatial layer (Merseyside boundary)\n  tm_borders(col = \"black\", lwd = 1) +  # Draw the boundaries with black lines of width 1\n  tm_text(\"LAD25NM\",col = \"blue\",size = 0.8)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab: Getting Started in RStudio - Knowing Merseyside</span>"
    ]
  }
]